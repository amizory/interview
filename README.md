# Interview

* [Linux](#Linux)
* [Web](#Web)
* [PostgreSQL](#PostgreSQL)
* [k8s](#k8s)
* [Ansible](#Ansible)
* [Bash](#Bash)
* [OBS](#OBS)

## Questions

### <a id="Linux">Linux</a>

```txt
1 - Место на диске?

->  df -h (--total)
    du -ms 

    - rm /var/log/postgresql/postgres.log -> удалить архивы
    - truncate -s 0 /var/log/postgresql/postgres.log -> подрезать
    - logrotate -d /var/log/postgresql/postgres.log -s 100M -m 7 
    - linux file system -> резервное место
    - clear journalctl -> vacuum
```

```txt
2 - Автозагрузка приложения

->  - systemctl edit --full name.service
      systemctl daemon-reload
    - etc/rc.local -> !#bin/bash -> /PATH -> exit 0
    - etc/systemd/system/name.service -> [Unit - Service - Install]
      systemctl enable name.service
    - .bashrc -> /PATH
    - update-rc.d name default
    - chkconfig name on  
```

```txt
3 - Память, cpu

->  top, lsmem, lscpu, free
    CPU - LoadAverage - число/количество ядер
```

```txt
4 - Таблица маршрутизации

->  - Маршрутизатор получает пакет - ICMP
    - Маршрутизатор проверяет таблицу маршрутизации
      (есть ли у него запись для адреса 8.8.8.8)
    - Маршрутизатор сравнивает адрес назначения с записями в таблице маршрутизации
      (сравнивает адрес назначения 8.8.8.8 с записями в таблице маршрутизации, в таблице 
      маршрутизации содержится информация о сетях и хостах, которые маршрутизатор знает)
    - Маршрутизатор ищет запись с наибольшим совпадением
      (маршрутизатор ищет запись в таблице маршрутизации, которая большего всего совпадает
      с адресом назначения 8.8.8.8 longest prefix match)
    - Маршрутизатор определяет следующий прыжок (если запись в таблице есть, то
      маршрутизатор определяет следующий hop для пакета, next hop -> адрес следующего 
      маршрутизатора или хоста, который пакет должен посетить на пути к адресу назначения)
    - Маршрутизатор пересылает пакет - на следующий hop, указанный в таблице маршрутизации

    RIP-ASN-OSPF-BGP
```

```txt
3 - ping vs traceroute

->  ping
    - icmp пакет к адресу и ожидает ответ
    - достигает - возвращает ответный пакет (информацию о времени передачи и других параметрах)
    - доступность адреса

    traceroute
    - udp пакет к указанному адресу с увеличивающимся TTL (сколько пакет может быть переслан
    маршрутизаторами прежде чем он будет удален)
    - traceroute-пакет - маршрутизатор - TTL уменьшается на 1 - и отправляет пакет дальше, 
      если TTL = 0 маршрутизатор отправляет icmp-пакет time exceeded обратно к отправителю
    - показывает узлы, потому что требует отправлять от маршрутизатора информацию о промежуточных
      узлах в ICMP-пакетах
    - диагностика сетевых проблем/промежуточные узлы 
```

### <a id="Web">Web</a>

```txt
1 - Методы HTTPS

->  GET, POST, PATCH, DELETE, OPTIONS, PUT, HEAD, PUSH, PRIORITY
    GET -> у него нет тела, передается в адресной строке, кешируется
    POST -> есть тело, отдельный заголовок
```

```txt
2 - Сертификаты

->  Синхронное быстрее, чем асинхронное (в контексте шифрование)
```

### <a id="PostgreSQL">PostgreSQL</a>

```txt
1 - Какие есть и где конфиги postgres?

->  1 - postgresql.conf -> psql -c "SHOW config_file;"
      - соединение 
      - безопасность
      - кеширование/буферизация
      - журналирование
    2 - pg_hba.conf -> psql -c "SHOW hba_file;"
      - доступа к базе данных (например, разрешение доступа к определенным базам данных,
        пользователям или группам)
      - аутентификация (например, пароли, SSL)
      - авторизация (например, права доступа к таблицам, представлениям)

    Могут быть etc/postgres/config
    Либо внутри postgres как кластерное решение
```

```txt
2 - Сетевой доступ к базе данных?

->  telnet, netcat, curl, busybox
```

```txt
3 - Пользователи

->  Юзер-группа -> устарели 
    login with -> user
    login without -> группа

    Роль = пользователь -> роль можно передавать другим пользователям

    Права - (изменение, удаление)-(схем, таблиц)
    Роль RO + пользователи -> db права -> GRANT ALL DEFAULT ON VIEWS TO testrole;
    template-0 | template-1

```

```txt
4 - Нет места на диске

->  Сборщик мусора -> 
    1 -> отмечает старые данные -> их можно перезаписывать -> DB не уменьшается
    2 -> отключает всех ->  DB уменьшается

    pg_archivecleanup -> это утилита, которая удаляет ненужные архивные файлы WAL из каталога 
                        архивов -d -n -v

    Write-Ahead Logging - это механизм, который используется в DB.
    - WAL - это журнал, который записывает все изменения, которые происходят в базе данных.
    - WAL записывает изменения перед тем, как они будут применены к базе данных.
    - WAL позволяет восстановить базу данных в случае сбоя или ошибки.
    - WAL обеспечивает целостность и надежность данных в базе данных.
    Пример:
    - Когда вы выполняете команду INSERT, UPDATE или DELETE в базе данных, WAL записывает
    изменения в журнал.
    - Если база данных выходит из строя или происходит ошибка, WAL позволяет восстановить базу
    данных до последнего известного состояния.

    Преимущества WAL:
    - Обеспечивает целостность и надежность данных в базе данных.
    - Позволяет восстановить базу данных в случае сбоя или ошибки.
    - Увеличивает производительность базы данных, поскольку изменения записываются в журнал
    перед тем, как они будут применены к базе данных.
```

### <a id="k8s">k8s</a>

```txt
1 - Обновить ядро linux на нодах кластера?

->  - sudo apt update | sudo apt upgrade | reboot
    - kubectl drain/uncordon <node-name>
```

```txt
2 - Пропинговать 2 пода 

->  svc -> clusterIP -> name.svc.namespace.cluster.local
```

```txt
3 - limits/requests

->  requests -> 
    - минимальное количество ресурсов, которые контейнер или под требует для работы
    - определяют количество ресурсов, которые будут выделены контейнеру или поду при его
      запуске

    limits -> 
    - это максимальное количество ресурсов, которые контейнер или под может использовать
    - определяют верхний предел ресурсов, которые контейнер или под может использовать
    - могут быть превышены, если контейнер или под требует больше ресурсов, чем указано в
      requests

    reboot -> DRAM
    throttling -> CPU 
```

```txt
4 - Метрики в кластере

->  kube-state-metrics
```

### <a id="Ansible">Ansible</a>

```txt
1 - Handlers

->  - Handler (обработчик) в Ansible - это специальный тип задачи, который выполняется только
    в том случае, если была изменена какая-либо переменная или ресурс.
    - Handler нужен для того, чтобы выполнять определенные действия после того, как были изменены
    какие-либо ресурсы или переменные. Например, если вы обновили конфигурацию веб-сервера,
    handler может перезапустить сервис, чтобы изменения вступили в силу.
    - Handler используется для выполнения действий, которые необходимо выполнить после изменения
    ресурсов или переменных. Это может быть перезапуск сервиса, reload конфигурации, отправка
    уведомления и т.д.
```

### <a id="Bash">Bash</a>

```txt
1 - Debug 

->  set -x -> позволит вам видеть команды, которые выполняются в скрипте, и их результаты
    set -e -> для остановки скрипта при возникновении ошибки
    set -u -> для вывода ошибки при использовании неопределенной переменной
    bash -v script.sh вывода команд, которые выполняются в скрипте
    bash -x script.sh для запуска скрипта в режиме отладки
```

### <a id="OBS">OBS</a>

```txt
1 - Логирование 

->  Настройка fluetbit  -> DS
    "autodiscovery"
    - docker - log-driver
    - k8s - var/log/containerd/pods
          - var/lib
```

```txt
2 - Различие

->  Logstash -> преобразователь логов (.json)
    Metrics -> prometheus -> 14days (TSDB)
```
